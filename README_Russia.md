# Лабораторная работа 1 по компьютерному зрению: Реализация фильтров
## Введение: 
Эта лабораторная работа посвящена созданию фундаментальных фильтров обработки изображений с нуля, используя только NumPy для вычислений и Matplotlib для визуализации. Цель — получить глубокое понимание того, как работают фильтры на уровне пикселей, а не полагаться на высокоуровневые библиотеки, такие как OpenCV.
В этой лабораторной работе необходимо было реализовать следующие фильтры:
1. Эрозия
2. Расширение
3. Медиана
4. Гауссово
5. Коррекция освещения
6. Гамма-коррекция
7. Бинаризация

## Фильтрация каналов RGB
Каждый фильтр применяется независимо к красному (R), зеленому (G) и синему (B) каналам изображения. Рабочий процесс выглядит следующим образом:
1. Разделите изображение RGB на три канала: R, G, B.
2. Примените фильтр к каждому каналу отдельно.
3. Объедините обработанные каналы вместе, чтобы сформировать окончательное отфильтрованное изображение RGB.

Этот метод гарантирует, что эффект фильтров будет отражен в составном изображении, сохраняя цветовые отношения между каналами.

## Реализованные фильтры:
### 1. Фильтр эрозии
Эрозия уменьшает границы объекта переднего плана, применяя минимальный фильтр. Он полезен для удаления небольшого белого шума и разделения двух связанных объектов.

**Математическая формула**:

$$\
E(x,y) = \min_{(i,j) \in K} I(x+i, y+j)
\$$

Где:
- $\ E(x,y)\$: значение размытого пикселя в позиции \$(x,y)\$
- $\ I(x+i, y+j) \$: значения пикселей в окрестности, определяемой ядром $\ K \$
- $\ K \$: структурирующий элемент (ядро), используемый для зондирования изображения

**Реализация кода**: ядро ​​скользит по изображению, и в каждой позиции минимальное значение пикселя в области ядра берется в качестве выходных данных. Это уменьшает яркие области и увеличивает темные области.
См. функцию `erode()` в `lab1.py`.

**Результаты**: После эрозии яркие области сужаются, особенно заметно в канале R (из-за оранжевого цвета шерсти кошки). Мелкие детали и белый шум также удаляются или уменьшаются. Темные области становятся более заметными из-за сужения светлых участков.
![](images/erode.png)

### 2. Фильтр расширения
Расширение добавляет пиксели к границам объектов, применяя максимальный фильтр. Это помогает соединить сломанные части объекта.

**Математическая формула**:

$$\
D(x,y) = \max_{(i,j) \in K} I(x+i, y+j)
\$$

Где:
- $\ D(x,y)\$: значение расширенного пикселя в позиции \$(x,y)\$
- $\ I(x+i, y+j) \$: значения пикселей в окрестности, определяемой ядром $\ K \$
- $\ K \$: структурирующий элемент (ядро), используемый для зондирования изображения

**Реализация кода**: Ядро перемещается по изображению, и в каждой позиции максимальное значение пикселя в ядре берется в качестве выходного значения. Это увеличивает яркие области и сжимает темные.
См. функцию `dilate()` в `lab1.py`

**Результаты**: Расширение имеет противоположный эффект эрозии; оно расширяет яркие области и сжимает темные области:
- Края и мелкие яркие детали стали более выраженными по сравнению с исходным изображением.
- Тонкие линии и яркие области выглядят толще, делая такие детали, как усы или мех, более заметными.
- Темные области были уменьшены, а яркие области расширены, что улучшило видимость в определенных областях.
![](images/dilate.png)

### 3. Медианный фильтр
Медианный фильтр заменяет каждый пиксель медианным значением его соседей. Это особенно эффективно для удаления шума типа «соль и перец».

**Математическая формула**:

$$\
M(x,y) = \text{median}\{I(x+i, y+j) | (i,j) \in K\}
\$$

**Реализация кода**: для каждого пикселя значения в его окрестности сортируются, а медианное значение присваивается центральному пикселю.

См. функцию `median()` в `lab1.py`

**Результаты**: Медианный фильтр эффективно удаляет шум типа «соль и перец», заменяя крайние значения пикселей более репрезентативными значениями из их окрестности. Отфильтрованный результат показывает:
- Снижение шума во всех каналах RGB.
- Более плавные переходы цветов без размытия резких краев.

![](images/median.png)

### 4. Фильтр Гаусса
Фильтрация Гаусса применяет свертку с ядром Гаусса, сглаживая изображение и уменьшая высокочастотный шум.

**Математическая формула**:

$$\
G(x,y) = \sum_{i,j} I(x+i, y+j) \cdot K(i,j)
\$$

Гауссово ядро ​​вычисляется как:

$$\
K(i,j) = \frac{1}{2\pi\sigma^2} e^{-\frac{i^2 + j^2}{2\sigma^2}}
\$$

где:
- $\ G(x,y)\$: выходное значение пикселя после гауссовой фильтрации в позиции
- $\ I(x+i, y+j)\$: значение пикселя в позиции на входном изображении
- $\ K(i,j)\$: значение гауссова ядра в позиции
- $\sigma$: стандартное отклонение гауссова распределения, контролирующее степень размытия

**Влияние $\sigma$**:
- **Маленькое $\sigma$** приводит к узкому гауссову ядру, вызывая минимальное размытие и сохраняя больше деталей.
- **Большое $\sigma$** приводит к более широкому ядру, что приводит к более сильному размытию и более плавным результатам, но ценой потери мелких деталей.

**Реализация кода**: Ядро представляет собой двумерную колоколообразную кривую, которая придает больший вес центральным пикселям и меньший — удаленным, что приводит к эффекту мягкого размытия.

См. функцию `gaussian()` в `lab1.py`

**Результаты**: После гауссова фильтра:
На основе изображения, обработанного гауссовым фильтром:
- Отфильтрованное изображение выглядит более гладким, с мелкими деталями, такими как шерсть кошки и края глаз, слегка размытыми.
- Основные контуры и формы кошки остаются четкими, что указывает на то, что гауссов фильтр размывает мягко, не полностью стирая важные детали.
- При сравнении каждого цветового канала небольшой шум уменьшается, но контраст между различными областями цвета сохраняется в разумных пределах.
  
![](images/guassian.png)

### 5. Коррекция освещения
Линейно регулирует яркость изображения, умножая значения пикселей на коэффициент яркости.

**Математическая формула**:

$$\
L(x,y) = clip(I(x,y) \times b, 0, 255)
\$$

**Выбор коэффициента яркости**:
- Коэффициент яркости больше 1 осветляет изображение.
- Коэффициент яркости меньше 1 затемняет изображение.
- Коэффициент 1 сохраняет изображение неизменным.

**Реализация кода**: Каждое значение пикселя масштабируется с постоянным коэффициентом, а значения ограничиваются диапазоном [0, 255]. Это эффективно для равномерного осветления или затемнения изображения.
См. функцию `ligjting_correction()` в `lab1.py`

**Результаты**: Фильтр коррекции освещения явно осветлил изображение, масштабируя интенсивность пикселей
- Отфильтрованное изображение заметно светлее по сравнению с оригиналом, с более яркими бликами и более живыми цветами.
- Все каналы RGB показывают увеличение интенсивности, из-за чего шерсть и усы кошки выделяются более отчетливо.
- Повышенная яркость также усилила контрастность, особенно в канале R (красный), из-за чего некоторые области выглядят переэкспонированными — очевидно по белым пятнам в отфильтрованных каналах R, G и B.

![](images/lighting-correction.png)

### 6. Гамма-коррекция
Гамма-коррекция регулирует интенсивность пикселей нелинейно, делая темные пиксели светлее или светлые пиксели темнее на основе гамма-фактора $\gamma$.

**Математическая формула**:

$$\
G(x,y) = 255 \times \left( \frac{I(x,y)}{255} \right)^{\gamma}
\$$

**Выбор значения гаммы**:
- $\gamma > 1\$: затемняет изображение, подчеркивая детали в ярких областях.
- $\gamma < 1\$: осветляет изображение, выявляя детали в темных областях.
- $\gamma = 1\$: изображение не изменяется.

**Реализация кода**:
См. функцию `gamma_correction()` в `lab1.py`

**Результаты**: При $\gamma = 0.5\$:
- Изображение выглядит ярче, увеличивается интенсивность полутонов и теней, темные области становятся светлее.
- Светлые участки становятся еще более выраженными, а контрастность может быть снижена
- Гамма-коррекция сохраняет больше нюансов в светлых областях, тогда как коррекция освещения может привести к переэкспонированию
  
![](images/gamma_correction.png)

На основе гистограммы цветовых каналов после применения гамма-коррекции можно увидеть, что:

- Ранее темные пиксели были «вытеснены» в правую часть гистограммы, что сделало общее изображение более ярким.
- Гистограммы показывают более высокую частоту значений пикселей около 255, что ясно указывает на улучшение детализации в темных областях.
- Интервал между полосами гистограммы в темных областях становится более выраженным, что показывает увеличение детализации в областях с низкой интенсивностью.
  
![](images/gamma-histogram.png)

### 7. Бинаризация
Бинаризация преобразует изображение в оттенках серого в бинарное изображение, где каждый пиксель либо черный, либо белый.

**Математическая формула**:

$$\
B(x,y) = \begin{cases}
255 & \text{if } I(x,y) > T \\
0 & \text{if } I(x,y) \leq T
\end{cases}
\$$

**Реализация кода**:
См. функцию `binarization()` в `lab1.py`

**Результаты**: После применения бинаризации к изображению:
- В каналах R, G, B после бинаризации заметные детали — особенно края и высококонтрастные области — становятся более заметными.
- Вся цветовая информация и промежуточные уровни серого удаляются, что делает изображение очень упрощенным, сохраняя только основную структуру.
  
![](images/binarization.png)

## Заключение
Благодаря внедрению различных фильтров — эрозии, расширения, медианы, гауссовского, коррекции освещения, гамма-коррекции и бинаризации — мы изучили ключевые методы обработки изображений, используемые в компьютерном зрении. Каждый фильтр служит уникальной цели:
- **Эрозия**: сжимает белые области, удаляя шум и небольшие белые области.
- **Расширение**: расширяет белые области, заполняя пробелы и соединяя компоненты.
- **Медианный фильтр**: уменьшает шум «соль-перец», заменяя каждый пиксель медианным значением его соседства.
- **Гауссовский фильтр**: сглаживает изображения, уменьшая высокочастотный шум с помощью гауссова ядра.
- **Коррекция освещения**: настраивает неравномерное освещение, повышая четкость изображения.
- **Гамма-коррекция**: нелинейно изменяет яркость изображения, полезно для улучшения деталей в тенях или светлых участках.
- **Бинаризация**: преобразует изображения в оттенках серого в двоичные, выделяя края и высококонтрастные области.
Понимание и реализация этих фильтров с нуля создает прочную основу для решения более сложных задач обработки изображений и компьютерного зрения.
